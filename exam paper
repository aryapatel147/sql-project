CREATE DATABASE eventmanagement;


CREATE TABLE Venues (
    venue_id INT PRIMARY KEY,
    venue_name VARCHAR(50),
    location VARCHAR(50),
    capacity INT
);

CREATE TABLE Organizers (
    organizer_id INT PRIMARY KEY,
    organizer_name VARCHAR(50),
    email VARCHAR(50),
    phone VARCHAR(15)
);

CREATE TABLE Events (
    event_id INT PRIMARY KEY,
    event_name VARCHAR(50),
    event_date DATE,
    venue_id INT,
    organizer_id INT,
    ticket_price INT,
    total_seats INT,
    available_seats INT,
    FOREIGN KEY (venue_id) REFERENCES Venues(venue_id),
    FOREIGN KEY (organizer_id) REFERENCES Organizers(organizer_id)
);

CREATE TABLE Attendees (
    attendee_id INT PRIMARY KEY,
    name VARCHAR(50),
    email VARCHAR(50),
    phone VARCHAR(15)
);

CREATE TABLE Tickets (
    ticket_id INT PRIMARY KEY,
    event_id INT,
    attendee_id INT,
    booking_date DATE,
    status VARCHAR(20),
    UNIQUE(event_id, attendee_id),
    FOREIGN KEY (event_id) REFERENCES Events(event_id),
    FOREIGN KEY (attendee_id) REFERENCES Attendees(attendee_id)
);

CREATE TABLE Payments (
    payment_id INT PRIMARY KEY,
    ticket_id INT,
    amount INT,
    payment_status VARCHAR(20),
    payment_date DATETIME,
    FOREIGN KEY (ticket_id) REFERENCES Tickets(ticket_id)
);

INSERT INTO Venues VALUES
(1,'City Hall','Ahmedabad',1000);

INSERT INTO Organizers VALUES
(1,'Arya Events','arya@gmail.com','9999999999');

INSERT INTO Events VALUES
(1,'Music Night','2025-01-15',1,1,500,100,60);

INSERT INTO Attendees VALUES
(1,'Rahul','rahul@gmail.com','8888888888');

INSERT INTO Tickets VALUES
(1,1,1,'2025-01-01','Confirmed');

INSERT INTO Payments VALUES
(1,1,500,'Success','2025-01-01 10:30:00');

SELECT * FROM Events;

UPDATE Events
SET ticket_price = 600
WHERE event_id = 1;

DELETE FROM Attendees
WHERE attendee_id = 2;

SELECT * FROM Events
WHERE event_date > CURDATE();

SELECT * FROM Events
LIMIT 5;

SELECT * FROM Events
WHERE MONTH(event_date) = 12
AND available_seats > 50;

SELECT * FROM Events
WHERE event_id NOT IN (
    SELECT event_id FROM Tickets
);

SELECT * FROM Events
ORDER BY event_date;

SELECT event_id, COUNT(*) AS total_bookings
FROM Tickets
GROUP BY event_id;

SELECT SUM(amount) AS total_revenue
FROM Payments
WHERE payment_status = 'Success';

SELECT AVG(ticket_price)
FROM Events;

SELECT event_name, venue_name
FROM Events, Venues
WHERE Events.venue_id = Venues.venue_id;

SELECT name
FROM Attendees
LEFT JOIN Tickets ON Attendees.attendee_id = Tickets.attendee_id
WHERE Tickets.ticket_id IS NULL;

SELECT event_id
FROM Tickets
GROUP BY event_id
HAVING COUNT(*) > 1;

SELECT event_name,
DATEDIFF(event_date, CURDATE()) AS days_left
FROM Events;

UPDATE Organizers
SET organizer_name = UPPER(organizer_name);

SELECT TRIM(name)
FROM Attendees;

SELECT event_name,
CASE
    WHEN available_seats < 20 THEN 'High Demand'
    WHEN available_seats < 50 THEN 'Medium Demand'
    ELSE 'Low Demand'
END AS demand
FROM Events;
